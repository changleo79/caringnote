# 📖 단계별 데이터베이스 설정 가이드

총 3가지 작업을 순서대로 진행하시면 됩니다.  
각 단계마다 스크린샷처럼 상세하게 설명해드립니다.

---

## 🎯 1단계: PostgreSQL 데이터베이스 생성

### 1. Vercel 대시보드 접속
1. 웹 브라우저를 열고 주소창에 입력: `https://vercel.com`
2. 로그인합니다
3. 로그인 후 오른쪽 위 모서리를 보면 **프로필 아이콘**(동그란 원)이 보입니다
4. 클릭하면 메뉴가 나타나고, **"Dashboard"**를 클릭합니다

### 2. 프로젝트 찾기
1. 대시보드 화면에서 **"care app"** 또는 여러분이 만든 프로젝트 이름을 찾습니다
2. 프로젝트 이름을 클릭하여 들어갑니다

### 3. Storage 메뉴 찾기
1. 프로젝트 페이지 상단에 여러 탭이 있습니다: **"Overview"**, **"Deployments"**, **"Settings"** 등
2. **"Storage"** 탭을 클릭합니다
   - 만약 보이지 않으면 **"Settings"** 탭 → 왼쪽 사이드바에서 **"Storage"** 찾기

### 4. 데이터베이스 생성
1. **"Create Database"** 또는 **"Add"** 버튼을 클릭합니다
2. 여러 데이터베이스 옵션이 나타납니다:
   - **Postgres** ← 이걸 선택합니다!
   - 다른 옵션들은 무시하고 Postgres만 선택
3. **"Continue"** 또는 **"Create"** 버튼 클릭
4. 설정 화면:
   - **Database Name**: `caringnote-db` (또는 원하는 이름)
   - **Region**: `Seoul (icn1)` 또는 `Tokyo` 선택
   - **Plan**: `Hobby` (무료) 선택
5. **"Create"** 버튼을 최종 클릭
6. 1-2분 정도 기다리면 **"Active"** 또는 **"Ready"** 상태로 변경됩니다

**✅ 1단계 완료!** 데이터베이스가 생성되었습니다.

---

## 🔐 2단계: 환경 변수 설정

### 1. 연결 정보 복사
1. 방금 만든 PostgreSQL 데이터베이스를 클릭합니다
2. 화면에서 다음 중 하나를 찾습니다:
   - **"Connection String"** 또는
   - **"DATABASE_URL"** 또는
   - **"Settings"** 또는 **"Connection Info"** 섹션
3. 전체 문자열을 복사합니다 (Ctrl+C 또는 Cmd+C)
   - 예시: `postgres://user:password@host:5432/database?sslmode=require`
   - 이 긴 문자열 전체를 복사하세요!

### 2. 환경 변수 페이지로 이동
1. 프로젝트 페이지로 돌아갑니다 (왼쪽 상단 프로젝트 이름 클릭)
2. 상단 탭에서 **"Settings"** 클릭
3. 왼쪽 사이드바 메뉴에서 **"Environment Variables"** 클릭

### 3. 환경 변수 추가
1. **"Add New"** 또는 **"Add Environment Variable"** 버튼 클릭
2. 두 개의 입력창이 나타납니다:
   - **Key (왼쪽)**: `DATABASE_URL` 입력 (정확히 대문자로!)
   - **Value (오른쪽)**: 아까 복사한 Connection String 붙여넣기 (Ctrl+V)
3. 아래쪽에 **Environment** 체크박스가 3개 있습니다:
   - ✅ **Production** 체크
   - ✅ **Preview** 체크  
   - ✅ **Development** 체크
   - (모두 체크하는 것을 권장합니다)
4. **"Save"** 버튼 클릭

### 4. 재배포 필수!
⚠️ **중요**: 환경 변수를 추가한 후에는 반드시 재배포해야 합니다!

1. 상단 탭에서 **"Deployments"** 클릭
2. 가장 위에 있는 배포(최신 배포)를 찾습니다
3. 오른쪽에 **"..."** (점 3개) 메뉴 클릭
4. **"Redeploy"** 선택
5. 확인 창에서 **"Redeploy"** 다시 클릭
6. 배포가 완료될 때까지 기다립니다 (1-2분)

**✅ 2단계 완료!** 환경 변수가 설정되고 재배포되었습니다.

---

## 🌱 3단계: 요양원 데이터 생성 (시드 데이터)

이제 데이터베이스에 테스트용 요양원 데이터를 추가합니다.

### 방법 A: 브라우저에서 쉽게 하기 (추천)

1. 웹 브라우저 주소창에 입력:
   ```
   https://[여기에-여러분의-vercel-url].vercel.app/api/care-centers/seed
   ```
   
   예시:
   - `https://care-app.vercel.app/api/care-centers/seed`
   - `https://caringnote-abc123.vercel.app/api/care-centers/seed`
   
   (정확한 URL은 Vercel 프로젝트 페이지의 "Overview" 탭에서 확인 가능)

2. 페이지가 열리면, 브라우저에서 **F12** 키를 누릅니다 (개발자 도구 열기)

3. 상단에서 **"Console"** 탭을 클릭합니다

4. Console 창 아래쪽 입력창에 다음 코드를 복사해서 붙여넣고 **Enter** 키:
   ```javascript
   fetch('/api/care-centers/seed', { method: 'POST' }).then(r => r.json()).then(console.log)
   ```

5. 결과가 나타나면:
   - 성공: `{ message: "시드 데이터 생성 완료", count: 3, ... }` 같은 메시지
   - 실패: 오류 메시지 확인

### 방법 B: API 테스트 도구 사용

1. **Postman** 또는 **Insomnia** 같은 도구 설치 (선택사항)

2. 새 요청 만들기:
   - **Method**: `POST` 선택
   - **URL**: `https://[your-vercel-url].vercel.app/api/care-centers/seed`
   - **Send** 버튼 클릭

### 방법 C: 회원가입 페이지에서 확인

시드 데이터가 생성되었는지 확인하는 방법:

1. 브라우저에서 접속:
   ```
   https://[your-vercel-url].vercel.app/auth/signup
   ```

2. 페이지를 아래로 스크롤하여 **"요양원 선택"** 드롭다운 찾기

3. 드롭다운을 클릭하면 다음이 보여야 합니다:
   - 행복 요양원
   - 사랑 요양원
   - 평화 요양원

4. 목록이 보이면 ✅ **성공!**
5. 목록이 비어있으면 시드 데이터가 아직 생성되지 않은 것입니다.

**✅ 3단계 완료!** 요양원 데이터가 생성되었습니다.

---

## 🎉 완료 체크리스트

모든 작업이 끝났는지 확인하세요:

- [ ] 1단계: PostgreSQL 데이터베이스가 Vercel에 생성되었습니다
- [ ] 2단계: DATABASE_URL 환경 변수가 설정되었습니다
- [ ] 2단계: 프로젝트가 재배포되었습니다
- [ ] 3단계: 시드 데이터가 생성되었습니다
- [ ] 회원가입 페이지에서 요양원 목록이 보입니다

---

## 🆘 문제가 발생했나요?

### "데이터베이스 연결 오류"가 나타나요?
→ **2단계**를 다시 확인하세요. 환경 변수 추가 후 재배포를 했는지 확인!

### "존재하지 않는 요양원입니다" 오류가 나요?
→ **3단계**를 다시 실행하세요. 시드 데이터 생성이 필요합니다.

### 회원가입 페이지에 요양원이 안 보여요?
→ **3단계**를 확인하세요. 시드 데이터 생성 API를 호출했는지 확인!

### 시드 API가 403 오류를 내나요?
→ Vercel Settings → Environment Variables에서 `ALLOW_SEED` 변수를 추가하세요:
   - Key: `ALLOW_SEED`
   - Value: `true`
   - 그리고 다시 재배포!

---

## 💡 팁

- 각 단계는 순서대로 진행해야 합니다
- 환경 변수 추가 후에는 **반드시 재배포**가 필요합니다
- 문제가 있으면 각 단계를 다시 확인해보세요

**이제 회원가입이 정상적으로 작동할 것입니다!** 🎊

