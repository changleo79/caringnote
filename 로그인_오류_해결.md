# 🔧 로그인 오류 해결 가이드

## 🚨 오류: "Server error - There is a problem with the server configuration"

이 오류는 보통 **NEXTAUTH_SECRET** 환경 변수가 설정되지 않아서 발생합니다.

---

## ✅ 즉시 해결 방법

### 1단계: Vercel 환경 변수 확인 및 추가

1. **Vercel 대시보드** 접속
2. 프로젝트 선택 (caringnote)
3. **Settings** → **Environment Variables**

4. 다음 환경 변수 확인:

#### 필수 환경 변수

| 변수명 | 값 | 상태 확인 |
|--------|-----|----------|
| `DATABASE_URL` | `postgresql://...` | ✅ 확인 |
| `NEXTAUTH_URL` | `https://caringnote.vercel.app` | ❓ 확인 필요 |
| `NEXTAUTH_SECRET` | 랜덤 문자열 | ❓ **확인 필요** |

### 2단계: NEXTAUTH_SECRET 생성 및 추가

#### 방법 A: 온라인 생성기 사용 (가장 빠름)

1. 브라우저에서 접속:
   ```
   https://generate-secret.vercel.app/32
   ```

2. 생성된 비밀키 복사

3. Vercel에서 환경 변수 추가:
   - **Key**: `NEXTAUTH_SECRET`
   - **Value**: 복사한 비밀키 붙여넣기
   - **Environment**: Production, Preview, Development 모두 체크
   - **Save** 클릭

#### 방법 B: PowerShell로 생성

PowerShell에서 실행:
```powershell
[Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Minimum 0 -Maximum 256 }))
```

결과를 복사해서 Vercel에 추가

### 3단계: NEXTAUTH_URL 확인

- **Key**: `NEXTAUTH_URL`
- **Value**: `https://caringnote.vercel.app` (정확히 이 값)
- **Environment**: Production, Preview, Development 모두 체크

### 4단계: 재배포

환경 변수를 추가한 후 **반드시 재배포**해야 합니다:

1. **Deployments** 탭
2. 최신 배포의 **"..."** 메뉴 클릭
3. **"Redeploy"** 선택
4. 배포 완료 대기 (1-2분)

---

## 🔍 확인하기

### 환경 변수 설정 확인

다음 URL로 접속하여 환경 변수 확인:
```
https://caringnote.vercel.app/api/db-check
```

결과에서:
- `NEXTAUTH_SECRET`: "설정됨 (***)" 또는 "설정 안 됨"

### 로그인 테스트

1. 회원가입한 계정으로 로그인 시도
2. 정상 작동하면 → 완료! ✅
3. 여전히 오류 → 다음 단계 확인

---

## 🆘 여전히 오류가 나면

### 오류 메시지 확인

Vercel 대시보드에서:
1. **Deployments** → 최신 배포 클릭
2. **Functions** 로그 확인
3. 오류 메시지 찾기

### 일반적인 오류

#### "NEXTAUTH_SECRET is missing"
→ 환경 변수를 추가하고 재배포하세요

#### "Invalid NEXTAUTH_URL"
→ `NEXTAUTH_URL`이 정확한 도메인인지 확인:
   - 정확: `https://caringnote.vercel.app`
   - 오류: `https://caringnote.vercel.app/` (끝에 슬래시 X)

#### "Database error"
→ 데이터베이스 연결 문제. `/api/db-check`로 확인

---

## ✅ 완료 체크리스트

- [ ] `NEXTAUTH_SECRET` 환경 변수 추가
- [ ] `NEXTAUTH_URL` 환경 변수 확인 (`https://caringnote.vercel.app`)
- [ ] 모든 환경(Production, Preview, Development)에 적용
- [ ] 재배포 완료
- [ ] 로그인 테스트 성공

---

## 💡 빠른 요약

1. **Vercel** → Settings → Environment Variables
2. `NEXTAUTH_SECRET` 추가 (https://generate-secret.vercel.app/32)
3. `NEXTAUTH_URL` 확인 (`https://caringnote.vercel.app`)
4. **재배포** 필수!
5. 로그인 테스트

**끝!** 🎉

